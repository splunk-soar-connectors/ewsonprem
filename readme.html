<!-- File: readme.html
  Copyright (c) 2016-2021 Splunk Inc.

  SPLUNK CONFIDENTIAL - Use or disclosure of this material in whole or in part
  without a valid written license from Splunk Inc. is PROHIBITED.
-->
<p>Use the Microsoft Exchange On-Premise EWS app to access a user's mailbox via EWS XML SOAP calls on an on-premise Exchange server. This can be done through impersonation, or high-level permissions. To use Splunk Phantom to organize and gain insights from email data, you need to install and connect Splunk Phantom to the Microsoft Exchange On-Premise EWS app.</p>
<p><strong>Impersonation and privileges</strong></p>
<p>When using impersonation, the app uses the current user to impersonate the target user to perform commands in the mailboxes the target user has access to. This can be configured in the user interface. When using high level permissions, many organizations configure an Exchange administrator account that has access to certain mailboxes. To give access to a user's mailbox to another user, use the <strong>Add-MailboxPermission</strong> PowerShell cmdlet on the Exchange Server.</p>
<p><strong>Install the Microsoft Exchange On-Premise EWS app</strong></p>
<p>To install the Microsoft Exchange On-Premise EWS app, follow these steps:</p>
<ul>
<li><strong>Download EWS for Exchange from <a href="https://my.phantom.us/4.9/apps/">my.phantom.us</a></strong></li>
<li>Log into your Splunk Phantom instance.</li>
<li>From the main menu, click Apps.&nbsp;</li>
<li>Click Install App.</li>
<li>Upload the app and click Install. </li>
</ul>
<p><strong>Configure the Microsoft Exchange On-Premise EWS app on Splunk Phantom</strong></p>
<p>To configure the Microsoft Exchange On-Premise EWS app, follow these steps:&nbsp;</p>
<ol>
<li>Search for the Microsoft Exchange On-Premise EWS app, then click <strong>Configure New Asset</strong>.&nbsp;</li>
<li>Click <strong>Asset Settings.</strong></li>
<li>Enter the following information:</li>
</ol>
<ul>
<li>EWS URL: The URL configured by the person that set up the Exchange server.</li>
<li>EWS Version: Ensure the version in the dropdown corresponds to the version of Exchange you have installed.&nbsp;</li>
<li>Username and Password: Use the username and password that have the correct privileges to access other mailboxes.&nbsp;</li>
<li>(Optional) User Email Mailbox: The mailbox you will ingest data from if you use polling and to test connectivity.&nbsp;</li>
<li>On poll information: Configure your desired on poll settings. For example, how to ingest, the number of emails to poll, what type of information you want to extract, and once extracted, your desired level of container severity. For more information on using on poll data ingestion, see Use on poll data ingestion.&nbsp;</li>
</ul>
<p><strong>Set up and use on poll data ingestion&nbsp;</strong></p>
<p>Using on poll data ingestion to schedule data ingestion from various emails. With this app, one container is created per email that is ingested. Artifacts are created within the container based on what the email contains; for example if the email included an IP address, an artifact of the IP address is created. To set up and use on poll data ingestion, follow these steps:&nbsp;</p>
<ol>
<li>On the Microsoft Exchange On-Premise EWS app, asset configuration page, click <strong>Ingest Settings</strong>.&nbsp;</li>
<li>Select a label to apply to objects from your data source.&nbsp;</li>
<li>Select a polling interval or schedule to configure polling on this asset. Select<strong> Interval </strong>to poll within a certain interval of time for example, every 60 minutes. Select <strong>Scheduled </strong>to more specifically schedule polling to the day, month, year, or hour.&nbsp;</li>
<li>Click <strong>Save</strong>.</li>
<li>Click <strong>Poll Now</strong> and select the maximum number of containers and artifacts you want created.&nbsp;</li>
<li>Click <strong>Poll Now</strong> to confirm.&nbsp;</li>
<li>Click <strong>Asset Settings &gt; Test Connectivity</strong> to ensure your settings pass.&nbsp;</li>
</ol>
<p><strong>Use the copy email command&nbsp;</strong></p>
<p>To use the copy email command, follow these steps:</p>
<ol>
<li>Navigate to the Investigation page.&nbsp;</li>
<li>Click <strong>Action</strong>.</li>
<li>In the search bar, search for the copy email command.</li>
<li>Click <strong>copy email</strong>.&nbsp;</li>
<li>Click <strong>exchange, </strong>or whatever asset name you created, as the asset you want to run the <strong>copy email</strong> command on.&nbsp;</li>
<li>Enter the ID. Each email in Exchange has a unique ID. You can get this email ID from an email artifact that was previously ingested, or by running a run query action.&nbsp;</li>
<li>Enter the email address of the user you want to copy the email from and the folder you want to copy the email to.</li>
<li>&nbsp;From the message ID, click the drop down arrow and click<strong> Run Action</strong>.</li>
<li>Enter the email and the folder you want to move it to.&nbsp;</li>
<li>&nbsp;Click <strong>Launch</strong>.&nbsp;</li>
</ol>